description: I'm writing to request the 8xA100 to process the data.

target:
  service: singularity
  name: palisades33
  workspace_name: azmlws2igshare

environment:
  image: amlt-sing/acpt-torch2.7.1-py3.10-cuda12.6-ubuntu22.04
  

storage:
  my_storage:
    storage_account_name: igshare
    container_name: v-zhifeng
    mount_dir: /scratch/v-zhifeng
  
code:
  local_dir: /home/v-zhifeng/HPE/empty_amlt_code
  # ignore:
  #   - agibotworld
  #   - .venv/
  #   - data/
  #   - checkpoints/
  #   - old_scripts/
    
jobs:
- name: pi05_ft_static_bs128_40G8A100_resized224_testgitclone
  sku: 40G8-A100
  priority: high
  preemptible: False
  identity: managed
  process_count_per_node: 1
  command:
  - sudo apt-get update
  - sudo apt-get install -y libglib2.0-0 libgl1 libsm6 libxext6 libxrender1
  - rm -r /scratch/amlt_code && mkdir -p /scratch/amlt_code/ && cd /scratch/amlt_code/
  - git clone https://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@github.com/AaronFengZY/openpi0.5.git .
  - curl -L "https://aka.ms/downloadazcopy-v10-linux" -o azcopy_v10.tar.gz
  - tar -xzf azcopy_v10.tar.gz
  - cd azcopy_linux_amd64_*
  - sudo mv azcopy /scratch/amlt_code/
  - cd /scratch/amlt_code/
  - pip install nvitop
  - sudo apt-get update && sudo apt-get install -y vim
  - bash setup_env.sh
  - source ~/.local/bin/env
  - mkdir -p /scratch/amlt_code/data
  - mkdir -p /scratch/amlt_code/checkpoints
  - ln -s /scratch/v-zhifeng/agibot_beta_split_500_resize_224/* /scratch/amlt_code/data/
  - ln -s /scratch/v-zhifeng/openpi/checkpoints/* /scratch/amlt_code/checkpoints/
  - >
    cd /scratch/amlt_code &&
    export WANDB_API_KEY=994cd7b5e79dffcab948d9a69766810153a12b48 &&
    export WANDB_ENTITY=aaronfeng24 &&
    EXP_NAME_ENV="fzy_test" bash ./scripts/train_jax.sh 128
  - sleep infinity


# code:
#   local_dir: /home/v-zhifeng/HPE/openpi/
#   ignore:
#     - agibotworld
#     - .venv/
#     - data/
#     - checkpoints/
#     - old_scripts/


  # - bash batch_azcopy.sh
  # - mkdir -p /scratch/amlt_code/data
  # - mkdir -p /scratch/amlt_code/checkpoints
  # - ln -s /scratch/amlt_code/agibot_beta_split_500_resize_224/* /scratch/amlt_code/data/
  # - ln -s /scratch/v-zhifeng/openpi/checkpoints/* /scratch/amlt_code/checkpoints/

  # - mkdir -p /scratch/amlt_code/data
  # - mkdir -p /scratch/amlt_code/checkpoints
  # - ln -s /scratch/v-zhifeng/agibot_beta_split_500_resize_224/* /scratch/amlt_code/data/
  # - ln -s /scratch/v-zhifeng/openpi/checkpoints/* /scratch/amlt_code/checkpoints/